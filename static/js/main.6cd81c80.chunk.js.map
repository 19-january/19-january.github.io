{"version":3,"sources":["components/Image.js","components/previews/AbstractPreview.js","components/previews/Vk.js","models/Vk/VkService.js","models/Vk/const.js","models/Vk/VkAuthService.js","helpers/read-file-async.js","components/AvatarEditor.js","helpers/download-url.js","App.js","index.js"],"names":["Image","props","useImage","src","image","imageRef","useRef","useEffect","current","cache","getLayer","batchDraw","ref","useStyles","makeStyles","preview","position","padding","AbstractPreview","width","height","bottomImage","backgroundSrc","backgroundScale","logoWidth","logoHeight","canvasRef","styles","containerRef","useState","scale","setScale","container","offsetWidth","Fragment","className","x","y","fill","scaleX","scaleY","Vk","VkService","authService","this","_auth","_queue","PromiseThrottle","requestsPerSecond","_call","fields","users","shift","photo_400_orig","method","params","paramsWithApiVersion","v","count","update","add","Promise","resolve","reject","VK","Api","call","response","authStatuses","VkAuthService","_checkSessionExpiration","_session","_getLoginStatus","session","status","_login","user","Auth","login","VkAuthError","getLoginStatus","timestamp","Math","round","Date","now","Boolean","expire","Error","readAsDataURLAsync","file","reader","FileReader","onload","result","onerror","readAsDataURL","AvatarEditor","previewsMap","vk","handleChange","field","event","setState","target","value","handleSliderChange","onBackgroundUpload","a","input","state","backgroundInputRef","files","dataURL","setBackgroundUrl","console","error","onSaveClick","canvas","url","name","link","document","createElement","download","href","body","appendChild","click","removeChild","downloadUrl","getStage","toDataURL","pixelRatio","onUploadBackgroundClick","imageType","backgroundImage","React","createRef","Preview","showImageScale","hasImage","FormControl","margin","fullWidth","Button","variant","color","startIcon","alt","onClick","fetchAvatar","accept","type","onChange","style","display","Typography","gutterBottom","Slider","min","max","step","Component","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.6cd81c80.chunk.js","sourcesContent":["import useImage from 'use-image/index';\nimport { Image as KonvaImage } from 'react-konva/lib/ReactKonvaCore';\nimport React, { useEffect, useRef } from 'react';\n\nexport const Image = (props) => {\n\tconst [image] = useImage(props.src, 'Anonymous');\n\tconst imageRef = useRef();\n\n\tuseEffect(() => {\n\t\tif (!image) {\n\t\t\treturn;\n\t\t}\n\n\t\t// небольшой хак для применения фильтров\n\t\timageRef.current.cache();\n\t\timageRef.current.getLayer().batchDraw();\n\t}, [image]);\n\n\treturn <KonvaImage ref={imageRef} image={image} {...props} />;\n};\n","import React, { useEffect, useRef, useState } from 'react';\nimport { Layer, Rect, Stage } from 'react-konva';\nimport { Image } from '../Image';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\n\nconst useStyles = makeStyles({\n\tpreview: {\n\t\tposition: 'relative',\n\t\tpadding: '1rem 0',\n\t},\n});\n\nexport const AbstractPreview = (props) => {\n\tconst {\n\t\twidth = 1080,\n\t\theight = 1080,\n\t\tpadding = 0,\n\t\tbottomImage,\n\t\tbackgroundSrc,\n\t\tbackgroundScale,\n\t\tlogoWidth,\n\t\tlogoHeight,\n\t\tcanvasRef,\n\t} = props;\n\n\tconst styles = useStyles(props);\n\tconst containerRef = useRef(null);\n\tconst [scale, setScale] = useState(1);\n\n\tuseEffect(() => {\n\t\tconst container = containerRef.current;\n\n\t\tif (!container) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetScale(container.offsetWidth / width);\n\t}, [width]);\n\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<div ref={containerRef} className={styles.preview}>\n\t\t\t\t<Stage\n\t\t\t\t\twidth={width * scale}\n\t\t\t\t\theight={height * scale}\n\t\t\t\t\tscale={{ x: scale, y: scale }}\n\t\t\t\t\tref={canvasRef}\n\t\t\t\t>\n\t\t\t\t\t<Layer>\n\t\t\t\t\t\t<Rect width={width} height={height} fill={'#dfdfdf'} />\n\n\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\tscaleX={backgroundScale}\n\t\t\t\t\t\t\tscaleY={backgroundScale}\n\t\t\t\t\t\t\tsrc={backgroundSrc}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\tx={0}\n\t\t\t\t\t\t\ty={height - bottomImage.height}\n\t\t\t\t\t\t\twidth={bottomImage.width}\n\t\t\t\t\t\t\theight={bottomImage.height}\n\t\t\t\t\t\t\tsrc={bottomImage.src}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Layer>\n\n\t\t\t\t\t<Layer>\n\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\tsrc=\"/images/logo.png\"\n\t\t\t\t\t\t\twidth={logoWidth}\n\t\t\t\t\t\t\theight={logoHeight}\n\t\t\t\t\t\t\ty={18 / 2}\n\t\t\t\t\t\t\tx={padding / 2}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Layer>\n\t\t\t\t</Stage>\n\t\t\t</div>\n\t\t</React.Fragment>\n\t);\n};\n","import React from 'react';\nimport { AbstractPreview } from './AbstractPreview';\n\nexport const Vk = ({ backgroundSrc, backgroundScale, canvasRef }) => (\n\t<AbstractPreview\n\t\twidth={400}\n\t\theight={600}\n\t\tpadding={70}\n\t\tlogoWidth={90}\n\t\tlogoHeight={138}\n\t\tbackgroundSrc={backgroundSrc}\n\t\tbackgroundScale={backgroundScale}\n\t\tcanvasRef={canvasRef}\n\t\tbottomImage={{ width: 400, height: 425, src: '/images/vk-down.png' }}\n\t/>\n);\n","/* global VK */\n\nimport { VK_API_VERSION, VK_DEFAULT_COUNT } from './const';\nimport PromiseThrottle from 'promise-throttle';\n\nclass VkService {\n\t/**\n\t * @param {VkAuthService} authService\n\t */\n\tconstructor(authService) {\n\t\tthis._auth = authService;\n\t\tthis._queue = new PromiseThrottle({ requestsPerSecond: 2 });\n\t}\n\n\t/**\n\t * @returns {Promise<string>}\n\t */\n\tasync fetchAvatar() {\n\t\tconst users = await this._call('users.get', {\n\t\t\tfields: 'photo_400_orig',\n\t\t});\n\n\t\treturn users.shift().photo_400_orig;\n\t}\n\n\t/**\n\t *\n\t * @param {string} method\n\t * @param {ApiParams} params\n\t * @returns {Promise<*>}\n\t * @private\n\t */\n\tasync _call(method, params) {\n\t\tconst paramsWithApiVersion = {\n\t\t\tv: VK_API_VERSION,\n\t\t\tcount: VK_DEFAULT_COUNT,\n\t\t\t...params,\n\t\t};\n\n\t\tawait this._auth.update();\n\n\t\treturn this._queue.add(\n\t\t\t() =>\n\t\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\t\tVK.Api.call(method, paramsWithApiVersion, (response) => {\n\t\t\t\t\t\tif (response.response) {\n\t\t\t\t\t\t\tresolve(response.response);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treject(response);\n\t\t\t\t\t});\n\t\t\t\t}),\n\t\t);\n\t}\n}\n\nexport { VkService };\n","/** Используемая версия API vk.com */\nexport const VK_API_VERSION = '5.126';\n\n/** Объём загружаемой коллекции по-умолчанию */\nexport const VK_DEFAULT_COUNT = 100;\n","/* global VK */\n\n/** Возможные статусы vk-openapi */\nconst authStatuses = {\n\tCONNECTED: 'connected',\n\tNOT_AUTHORIZED: 'not_authorized',\n\tUNKNOWN: 'unknown',\n};\n\n/**\n * Сервис авторизации vk.com\n */\nclass VkAuthService {\n\t/**\n\t * @type {VK.Auth.Session}\n\t * @private\n\t */\n\t_session;\n\n\tasync update() {\n\t\tif (this._checkSessionExpiration()) {\n\t\t\treturn Promise.resolve(this._session);\n\t\t}\n\n\t\tconst { session, status } = await this._getLoginStatus();\n\n\t\tif (status === authStatuses.CONNECTED) {\n\t\t\tthis._session = session;\n\t\t\treturn Promise.resolve(session);\n\t\t}\n\n\t\treturn this._login();\n\t}\n\n\tgetUser() {\n\t\treturn this._session.user;\n\t}\n\n\t_login() {\n\t\treturn new Promise((resolve) => {\n\t\t\tVK.Auth.login(({ session, status }) => {\n\t\t\t\tif (status !== authStatuses.CONNECTED) {\n\t\t\t\t\tthrow new VkAuthError();\n\t\t\t\t}\n\n\t\t\t\tthis._session = session;\n\t\t\t\tresolve(session);\n\t\t\t}, 1);\n\t\t});\n\t}\n\n\t_getLoginStatus() {\n\t\treturn new Promise((resolve) => VK.Auth.getLoginStatus(resolve));\n\t}\n\n\t_checkSessionExpiration() {\n\t\tconst timestamp = Math.round(Date.now() / 1000);\n\t\treturn Boolean(this._session && this._session.expire > timestamp);\n\t}\n}\n\nexport class VkAuthError extends Error {}\n\nexport { VkAuthService };\n","/**\n * Promise-обёртка для FileReader.readAsDataURL\n *\n * @param {File} file\n * @returns {Promise<Blob>}\n */\nexport function readAsDataURLAsync(file) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet reader = new FileReader();\n\n\t\treader.onload = () => {\n\t\t\tresolve(reader.result);\n\t\t};\n\n\t\treader.onerror = reject;\n\n\t\treader.readAsDataURL(file);\n\t})\n}\n","import FormControl from '@material-ui/core/FormControl';\nimport Button from '@material-ui/core/Button';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport Typography from '@material-ui/core/Typography';\nimport Slider from '@material-ui/core/Slider';\nimport SaveIcon from '@material-ui/icons/Save';\nimport React from 'react';\nimport { Vk } from './previews/Vk';\nimport { VkService } from '../models/Vk/VkService';\nimport { VkAuthService } from '../models/Vk/VkAuthService';\nimport { readAsDataURLAsync } from '../helpers/read-file-async';\nimport { downloadUrl } from '../helpers/download-url';\n\nclass AvatarEditor extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\timageType: 'vk',\n\t\t\tbackgroundImage: '',\n\t\t\tbackgroundScale: 1,\n\t\t\tcanvasRef: React.createRef(),\n\t\t\tbackgroundInputRef: React.createRef(),\n\t\t};\n\t}\n\n\t/**\n\t * @type {Object<string, function>}\n\t */\n\tpreviewsMap = {\n\t\tvk: Vk,\n\t};\n\n\t/**\n\t * @type {VkService}\n\t */\n\tvk = new VkService(new VkAuthService());\n\n\t/**\n\t * @param {string} field\n\t * @returns {function(Event): void}\n\t */\n\thandleChange = (field) => (event) =>\n\t\tthis.setState({ [field]: event.target.value });\n\n\t/**\n\t * @param {string} field\n\t * @returns {function(Event, number): void}\n\t */\n\thandleSliderChange = (field) => (event, value) =>\n\t\tthis.setState({ [field]: value });\n\n\t/**\n\t * @returns {Promise<void>}\n\t */\n\tonBackgroundUpload = async () => {\n\t\tconst input = (this.state.backgroundInputRef || {}).current;\n\n\t\tif (!input) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst dataURL = await readAsDataURLAsync(input.files[0]);\n\t\t\tthis.setBackgroundUrl(dataURL);\n\t\t} catch (e) {\n\t\t\tconsole.error('Ошибка при загрузке фона: ', e);\n\t\t}\n\t};\n\n\t/**\n\t * @param {string|blob} url\n\t * @returns {void}\n\t */\n\tsetBackgroundUrl(url) {\n\t\tthis.setState({ backgroundImage: url, backgroundScale: 1 });\n\t}\n\n\t/**\n\t * @returns {null|void}\n\t */\n\tonSaveClick = () => {\n\t\tconst canvas = (this.state.canvasRef || {}).current;\n\n\t\tif (!canvas) {\n\t\t\treturn;\n\t\t}\n\n\t\tdownloadUrl(\n\t\t\tcanvas.getStage().toDataURL({ pixelRatio: 2 }),\n\t\t\t'19-января',\n\t\t);\n\t};\n\n\t/**\n\t * @returns {null|void}\n\t */\n\tonUploadBackgroundClick = () =>\n\t\tthis.state.backgroundInputRef &&\n\t\tthis.state.backgroundInputRef.current.click();\n\n\trender() {\n\t\tconst Preview = this.previewsMap[this.state.imageType];\n\t\tconst showImageScale = Boolean(this.state.backgroundImage);\n\t\tconst hasImage = Boolean(this.state.backgroundImage);\n\n\t\treturn (\n\t\t\t<div className=\"avatar-editor__content\">\n\t\t\t\t<div className=\"avatar-editor__form\">\n\t\t\t\t\t<FormControl margin=\"normal\" fullWidth={true}>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\tfullWidth={true}\n\t\t\t\t\t\t\tstartIcon={\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\talt={'логотип vk'}\n\t\t\t\t\t\t\t\t\tsrc={'/images/vk-logo.svg'}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonClick={async () =>\n\t\t\t\t\t\t\t\tthis.setBackgroundUrl(\n\t\t\t\t\t\t\t\t\tawait this.vk.fetchAvatar(),\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tИспользовать аватар\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</FormControl>\n\n\t\t\t\t\t<FormControl fullWidth={true}>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\tref={this.state.backgroundInputRef}\n\t\t\t\t\t\t\tonChange={this.onBackgroundUpload}\n\t\t\t\t\t\t\tstyle={{ display: 'none' }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\tfullWidth={true}\n\t\t\t\t\t\t\tstartIcon={<CloudUploadIcon />}\n\t\t\t\t\t\t\tonClick={this.onUploadBackgroundClick}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tЗагрузить изображение\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</FormControl>\n\n\t\t\t\t\t{showImageScale && (\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\tfullWidth={true}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Typography gutterBottom>\n\t\t\t\t\t\t\t\tМасштаб изображения\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t<Slider\n\t\t\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\t\t\tmax={3}\n\t\t\t\t\t\t\t\tstep={0.01}\n\t\t\t\t\t\t\t\tvalue={this.state.backgroundScale}\n\t\t\t\t\t\t\t\tonChange={this.handleSliderChange(\n\t\t\t\t\t\t\t\t\t'backgroundScale',\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{hasImage && (\n\t\t\t\t\t\t<FormControl margin=\"normal\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\tstartIcon={<SaveIcon />}\n\t\t\t\t\t\t\t\tonClick={this.onSaveClick}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tСохранить\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"avatar-editor__preview\">\n\t\t\t\t\t<Preview\n\t\t\t\t\t\tbackgroundSrc={this.state.backgroundImage}\n\t\t\t\t\t\tbackgroundScale={this.state.backgroundScale}\n\t\t\t\t\t\tcanvasRef={this.state.canvasRef}\n\t\t\t\t\t\timageType={this.state.imageType}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport { AvatarEditor };\n","/**\n * Скачать data-URI\n *\n * @param {string} url - data-URL\n * @param {string} name - имя файла\n */\nexport function downloadUrl(url, name) {\n\tconst link = document.createElement('a');\n\tlink.download = name;\n\tlink.href = url;\n\tdocument.body.appendChild(link);\n\tlink.click();\n\tdocument.body.removeChild(link);\n}\n","import React from 'react';\nimport { AvatarEditor } from './components/AvatarEditor';\n\n/**\n * Генератор SMM-изображений\n */\nclass App extends React.Component {\n\t/**\n\t * @returns {JSX.Element}\n\t */\n\trender() {\n\t\treturn <AvatarEditor />;\n\t}\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('avatar-editor'),\n);\n"],"sourceRoot":""}